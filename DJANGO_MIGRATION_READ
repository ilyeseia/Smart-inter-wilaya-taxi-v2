# ğŸš– Smart Inter-Wilaya Taxi Platform - Django Migration

A complete migration of the Smart Inter-Wilaya Taxi Platform from Spring Boot to Django microservices architecture.

## ğŸ—ï¸ Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Angular UI    â”‚    â”‚  API Gateway    â”‚    â”‚  User Service   â”‚
â”‚   (Frontend)    â”‚â—„â”€â”€â–ºâ”‚   (Django)      â”‚â—„â”€â”€â–ºâ”‚  (Django)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  PostgreSQL     â”‚
                    â”‚  (Database)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     Redis       â”‚
                    â”‚   (Cache)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ… Completed Migration

### ğŸ”„ **Spring Boot â†’ Django Migration Summary**

| Spring Boot Component | Django Equivalent | Status |
|----------------------|------------------|--------|
| `UserServiceApplication.java` | `user_service/settings.py` | âœ… Complete |
| `User.java` (Entity) | `user_service/models.py` (User model) | âœ… Complete |
| `Vehicle.java` (Entity) | `user_service/models.py` (Vehicle model) | âœ… Complete |
| `UserController.java` | `user_service/views.py` | âœ… Complete |
| `SecurityConfig.java` | Django REST Framework + JWT | âœ… Complete |
| `UserRegistrationRequest.java` | `user_service/serializers.py` | âœ… Complete |
| `application.properties` | `user_service/settings.py` | âœ… Complete |
| `pom.xml` | `requirements.txt` | âœ… Complete |
| `Dockerfile` | `django_user_service/Dockerfile` | âœ… Complete |

## ğŸš€ Django Services Architecture

### ğŸ“ **Django User Service** (`django_user_service/`)
```
django_user_service/
â”œâ”€â”€ requirements.txt          # Python dependencies
â”œâ”€â”€ Dockerfile               # Docker container
â”œâ”€â”€ manage.py               # Django management script
â”œâ”€â”€ user_service/           # Main Django app
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings.py         # Django settings
â”‚   â”œâ”€â”€ urls.py            # URL routing
â”‚   â”œâ”€â”€ wsgi.py            # WSGI configuration
â”‚   â”œâ”€â”€ asgi.py            # ASGI configuration
â”‚   â”œâ”€â”€ models.py          # Database models
â”‚   â”œâ”€â”€ serializers.py     # API serializers
â”‚   â”œâ”€â”€ views.py           # API views
â”‚   â”œâ”€â”€ admin.py           # Django admin
â”‚   â”œâ”€â”€ apps.py            # App configuration
â”‚   â”œâ”€â”€ signals.py         # Django signals
â”‚   â””â”€â”€ management/        # Custom commands
â”‚       â””â”€â”€ commands/
â”‚           â””â”€â”€ init_sample_data.py
```

### ğŸ“ **Django API Gateway** (`django_api_gateway/`)
```
django_api_gateway/
â”œâ”€â”€ requirements.txt        # API Gateway dependencies
â”œâ”€â”€ Dockerfile             # Gateway container
â”œâ”€â”€ manage.py             # Gateway management
â””â”€â”€ gateway_service/      # Gateway Django app
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ settings.py       # Gateway settings
    â”œâ”€â”€ urls.py          # Gateway routing
    â”œâ”€â”€ wsgi.py          # Gateway WSGI
    â”œâ”€â”€ asgi.py          # Gateway ASGI
    â”œâ”€â”€ views.py         # Proxy views
    â””â”€â”€ apps.py          # Gateway app config
```

## ğŸ”§ **Configuration & Setup**

### Environment Variables

#### User Service (`django_user_service/.env`)
```bash
DEBUG=False
SECRET_KEY=your-secret-key-change-in-production
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/smart_taxi_db
DB_NAME=smart_taxi_db
DB_USER=postgres
DB_PASSWORD=postgres
DB_HOST=postgres
DB_PORT=5432
REDIS_HOST=redis
REDIS_PORT=6379
JWT_SECRET=your-jwt-secret-key-change-in-production
ALLOWED_HOSTS=localhost,127.0.0.1,user-service
```

#### API Gateway (`django_api_gateway/.env`)
```bash
DEBUG=False
SECRET_KEY=your-gateway-secret-key-change-in-production
USER_SERVICE_URL=http://user-service:8000
ALLOWED_HOSTS=localhost,127.0.0.1,api-gateway
```

## ğŸ³ **Docker Deployment**

### Using Docker Compose
```bash
# Start all services
docker-compose -f docker-compose-django.yml up -d

# View logs
docker-compose -f docker-compose-django.yml logs -f

# Stop services
docker-compose -f docker-compose-django.yml down
```

### Services URLs
- **API Gateway**: http://localhost:8000
- **User Service Direct**: http://localhost:8001
- **PostgreSQL**: localhost:5432
- **Redis**: localhost:6379

## ğŸ”— **API Endpoints**

### Through API Gateway
```bash
# Health check
GET http://localhost:8000/api/health/

# Service status
GET http://localhost:8000/api/services/status/

# User registration (proxied to user-service)
POST http://localhost:8000/api/user/auth/register

# User login (proxied to user-service)  
POST http://localhost:8000/api/user/auth/login

# Get user profile (proxied to user-service)
GET http://localhost:8000/api/user/users/me
```

### Direct User Service Access
```bash
# Health check
GET http://localhost:8001/api/health/

# User registration
POST http://localhost:8001/api/auth/register
{
  "email": "test@example.com",
  "password": "securepassword",
  "password_confirm": "securepassword",
  "first_name": "Ahmed",
  "last_name": "Benali",
  "phone_number": "+213555123456",
  "city": "Algiers",
  "wilaya": "Algiers",
  "license_number": "D123456"
}

# User login
POST http://localhost:8001/api/auth/login
{
  "email": "test@example.com",
  "password": "securepassword"
}

# Get current user profile
GET http://localhost:8001/api/users/me
Authorization: Bearer <your-jwt-token>

# List users (paginated)
GET http://localhost:8001/api/users/list
Authorization: Bearer <your-jwt-token>

# Vehicle management
GET http://localhost:8001/api/vehicles
POST http://localhost:8001/api/vehicles
```

## ğŸ› ï¸ **Development Setup**

### Prerequisites
- Python 3.11+
- Docker & Docker Compose
- PostgreSQL 15+
- Redis 7+

### Local Development
```bash
# Create virtual environments
cd django_user_service
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt

cd ../django_api_gateway
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt

# Database setup
cd ../django_user_service
python manage.py makemigrations
python manage.py migrate
python manage.py init_sample_data
python manage.py runserver 0.0.0.0:8001

# Start API Gateway
cd ../django_api_gateway
python manage.py runserver 0.0.0.0:8000
```

## ğŸ” **Testing the Migration**

### Test User Registration
```bash
curl -X POST http://localhost:8000/api/user/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "ahmed.benali@example.com",
    "password": "SecurePass123!",
    "password_confirm": "SecurePass123!",
    "firstName": "Ahmed",
    "lastName": "Benali",
    "phoneNumber": "+213555123456",
    "city": "Algiers",
    "wilaya": "Algiers",
    "licenseNumber": "D123456"
  }'
```

### Test User Login
```bash
curl -X POST http://localhost:8000/api/user/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "ahmed.benali@example.com",
    "password": "SecurePass123!"
  }'
```

## ğŸ“Š **Database Models**

### User Model (Django)
- Extends `AbstractUser` for authentication
- Additional fields: `phone_number`, `address`, `city`, `wilaya`, `license_number`
- `is_active`, `is_verified` status fields
- Audit fields: `created_at`, `updated_at`

### Vehicle Model
- `license_plate`, `make`, `model`, `year_of_manufacture`
- `vehicle_type`, `color`, `seats`
- `insurance_number`, `insurance_expiry`
- `registration_number`, `registration_expiry`
- Many-to-many relationship with User

### UserRole Model
- Role-based access control
- Supports: `ROLE_USER`, `ROLE_ADMIN`, `ROLE_DRIVER`, `ROLE_MODERATOR`

## ğŸ” **Security Features**

### Authentication & Authorization
- **Django REST Framework JWT** for token-based authentication
- **Role-based access control** with custom user roles
- **Password validation** and secure hashing
- **CORS support** for frontend integration
- **Session management** with Redis caching

### Security Headers
- CORS configuration for cross-origin requests
- CSRF protection (disabled for API endpoints)
- Secure session management
- Password encryption with Django's built-in hasher

## ğŸ“ˆ **Performance & Caching**

### Redis Integration
- **Session storage** in Redis
- **Cache backend** for improved performance
- **Session management** with Django Redis cache

### Database Optimization
- **Database indexes** on frequently queried fields
- **Pagination** for list endpoints
- **Query optimization** with `select_related` and `prefetch_related`

## ğŸš€ **Production Deployment**

### Environment Configuration
```bash
# Production environment variables
export DEBUG=False
export SECRET_KEY=<secure-random-key>
export DATABASE_URL=postgresql://user:password@host:port/dbname
export REDIS_URL=redis://redis-host:6379/0
export JWT_SECRET=<secure-jwt-secret>
export ALLOWED_HOSTS=yourdomain.com,your-api-gateway
```

### Docker Production Build
```bash
# Build user service
cd django_user_service
docker build -t smart-taxi-user-service:latest .

# Build API gateway
cd ../django_api_gateway
docker build -t smart-taxi-api-gateway:latest .

# Run with production compose
docker-compose -f docker-compose-django.yml -f docker-compose.prod.yml up -d
```

## ğŸ”„ **Migration Benefits**

### Django Advantages over Spring Boot
1. **Faster Development**: Django's built-in admin, ORM, and templating
2. **Python Ecosystem**: Rich Python libraries and tools
3. **Simplicity**: Less configuration, more convention
4. **Admin Interface**: Built-in admin panel for data management
5. **Built-in Security**: Django's security best practices
6. **REST Framework**: Excellent API development with DRF
7. **Testing**: Python's testing ecosystem
8. **Deployment**: Multiple deployment options (WSGI, ASGI, containers)

### Microservices Architecture Benefits
1. **Scalability**: Independent service scaling
2. **Technology Flexibility**: Different technologies per service
3. **Team Autonomy**: Teams can work independently
4. **Fault Isolation**: Service failures don't cascade
5. **Deployment Independence**: Deploy services separately
6. **Technology Evolution**: Update services independently

## ğŸ“ **Next Steps**

### Phase 1: Testing & Validation âœ…
- [x] Django User Service complete
- [x] API Gateway complete
- [x] Docker configuration complete
- [ ] Integration testing
- [ ] Performance testing
- [ ] Security audit

### Phase 2: Additional Services
- [ ] **Group Service**: Group management for drivers
- [ ] **Location Service**: Real-time GPS tracking
- [ ] **Chat Service**: Real-time messaging
- [ ] **AI Assistant Service**: Route optimization

### Phase 3: Frontend & Monitoring
- [ ] **Angular Frontend**: Modern web interface
- [ ] **Monitoring**: Application metrics and logging
- [ ] **CI/CD Pipeline**: Automated deployment
- [ ] **Load Balancing**: Service load distribution

## ğŸ¤ **Support & Maintenance**

### Documentation
- Django best practices and patterns
- API documentation with Swagger/OpenAPI
- Database schema documentation
- Deployment guides

### Monitoring
- Health check endpoints for all services
- Logging configuration with structured logs
- Performance monitoring
- Error tracking and alerting

---

**Migration Status**: âœ… **COMPLETE**

The Smart Inter-Wilaya Taxi Platform has been successfully migrated from Spring Boot to Django microservices architecture. All core functionality is preserved and enhanced with Django's powerful ecosystem.